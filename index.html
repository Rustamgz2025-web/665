<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–∞—Ä–≥–æ 665 | –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç –ª–æ–≥–∏—Å—Ç–∏–∫–∏</title>
    <style>
        :root {
            --primary: #1a1a1a;
            --accent: #f39c12; /* –§–∏—Ä–º–µ–Ω–Ω—ã–π –æ—Ä–∞–Ω–∂–µ–≤—ã–π Cargo 665 */
            --accent-hover: #e67e22;
            --bg-body: #f4f7f6;
            --bg-card: #ffffff;
            --text-main: #2c3e50;
            --text-light: #7f8c8d;
            --border-color: #dcdde1;
            --success: #27ae60;
            --shadow: 0 10px 30px rgba(0,0,0,0.08);
            --radius: 12px;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-body);
            color: var(--text-main);
            line-height: 1.6;
        }

        .container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header */
        header {
            background: var(--primary);
            color: white;
            padding: 20px 0;
            margin-bottom: 40px;
            box-shadow: var(--shadow);
        }

        .header-flex {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.5rem;
            font-weight: 800;
            letter-spacing: 1px;
        }

        .logo span {
            color: var(--accent);
        }

        .contact-info {
            text-align: right;
            font-size: 0.85rem;
        }

        /* Main Layout */
        .app-grid {
            display: grid;
            grid-template-columns: 1fr 380px;
            gap: 30px;
            margin-bottom: 50px;
        }

        @media (max-width: 900px) {
            .app-grid {
                grid-template-columns: 1fr;
            }
        }

        .card {
            background: var(--bg-card);
            border-radius: var(--radius);
            padding: 30px;
            box-shadow: var(--shadow);
        }

        h2 {
            margin-bottom: 25px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        h2::before {
            content: '';
            display: inline-block;
            width: 4px;
            height: 24px;
            background: var(--accent);
            border-radius: 2px;
        }

        /* Form Elements */
        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            font-size: 0.9rem;
            color: var(--text-main);
        }

        .input-wrapper {
            position: relative;
        }

        input, select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s;
            outline: none;
        }

        input:focus, select:focus {
            border-color: var(--accent);
        }

        .input-suffix {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-light);
            font-size: 0.85rem;
            pointer-events: none;
        }

        .grid-inputs {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .checkbox-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 15px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.85rem;
            cursor: pointer;
            padding: 8px;
            border: 1px solid #eee;
            border-radius: 6px;
            transition: 0.2s;
        }

        .checkbox-item:hover {
            background: #fcfcfc;
        }

        .checkbox-item input {
            width: auto;
        }

        /* Result Sidebar */
        .result-card {
            position: sticky;
            top: 100px;
            background: var(--primary);
            color: white;
            display: flex;
            flex-direction: column;
        }

        .result-title {
            color: var(--text-light);
            text-transform: uppercase;
            font-size: 0.75rem;
            letter-spacing: 1px;
            margin-bottom: 5px;
        }

        .main-price {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--accent);
            margin-bottom: 20px;
        }

        .price-details {
            border-top: 1px solid rgba(255,255,255,0.1);
            padding-top: 20px;
            flex-grow: 1;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            font-size: 0.9rem;
        }

        .detail-label {
            color: #ccc;
        }

        .detail-value {
            font-weight: 600;
        }

        .warning-box {
            background: rgba(243, 156, 18, 0.1);
            border-left: 3px solid var(--accent);
            padding: 15px;
            margin-top: 20px;
            font-size: 0.8rem;
            color: #efefef;
        }

        .btn-print {
            background: var(--accent);
            color: var(--primary);
            border: none;
            padding: 15px;
            border-radius: 8px;
            font-weight: 700;
            font-size: 1rem;
            cursor: pointer;
            width: 100%;
            margin-top: 25px;
            transition: background 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .btn-print:hover {
            background: var(--accent-hover);
        }

        /* Info Section */
        .info-section {
            margin-bottom: 60px;
        }

        .info-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            overflow-x: auto;
            padding-bottom: 5px;
        }

        .tab-btn {
            padding: 10px 20px;
            background: #ddd;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            white-space: nowrap;
            font-weight: 600;
            font-size: 0.85rem;
        }

        .tab-btn.active {
            background: var(--primary);
            color: white;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }

        th, td {
            text-align: left;
            padding: 12px;
            border-bottom: 1px solid var(--border-color);
        }

        th {
            background: #f8f9fa;
            color: var(--text-light);
            font-weight: 600;
        }

        .highlight-row {
            background: rgba(243, 156, 18, 0.05);
            font-weight: 600;
        }

        /* Print Template (Hidden by default) */
        #print-template {
            display: none;
        }

        @media print {
            body * {
                visibility: hidden;
            }
            #print-template, #print-template * {
                visibility: visible;
            }
            #print-template {
                display: block;
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                background: white;
                color: black;
                padding: 40px;
            }
            .no-print { display: none !important; }
        }

        .print-header {
            display: flex;
            justify-content: space-between;
            border-bottom: 2px solid #333;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }

        .offer-title {
            font-size: 24px;
            font-weight: 800;
            margin-bottom: 10px;
        }

        .print-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            margin-bottom: 30px;
        }

        .print-footer {
            margin-top: 50px;
            border-top: 1px solid #eee;
            padding-top: 20px;
            font-size: 12px;
            color: #666;
        }
    </style>
</head>
<body>

<header class="no-print">
    <div class="container">
        <div class="header-flex">
            <div class="logo">üöÄ –ö–ê–†–ì–û <span>665</span></div>
            <div class="contact-info">
                <div>Telegram: @cargo665</div>
                <div>WhatsApp: +7 (916) 028-12-61</div>
            </div>
        </div>
    </div>
</header>

<main class="container">
    <div class="app-grid no-print">
        <!-- Input Section -->
        <div class="card">
            <h2>–†–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏</h2>
            
            <div class="form-group">
                <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è —Ç–æ–≤–∞—Ä–æ–≤</label>
                <select id="category" onchange="calculate()">
                    <option value="household">–•–æ–∑—Ç–æ–≤–∞—Ä—ã (–ê–≤—Ç–æ-—Å—Ç–∞–Ω–¥–∞—Ä—Ç 30-35 –¥–Ω–µ–π)</option>
                    <option value="clothing">–û–¥–µ–∂–¥–∞ (–ê–≤—Ç–æ-—Å—Ç–∞–Ω–¥–∞—Ä—Ç 30-35 –¥–Ω–µ–π)</option>
                    <option value="shoes">–û–±—É–≤—å (–ê–≤—Ç–æ-—ç–∫—Å–ø—Ä–µ—Å—Å 10-15 –¥–Ω–µ–π)</option>
                    <option value="furniture">–ú–µ–±–µ–ª—å / –õ—é—Å—Ç—Ä—ã / –°—É–º–∫–∏ (–ú–æ—Å–∫–≤–∞-—ç–∫—Å–ø—Ä–µ—Å—Å 8-12 –¥–Ω–µ–π)</option>
                    <option value="taobao">Taobao (–ú–æ—Å–∫–≤–∞ 25-40 –¥–Ω–µ–π)</option>
                </select>
            </div>

            <div class="grid-inputs">
                <div class="form-group">
                    <label>–û–±—â–∏–π –≤–µ—Å</label>
                    <div class="input-wrapper">
                        <input type="number" id="weight" value="10" min="10" step="0.1" oninput="calculate()">
                        <span class="input-suffix">–∫–≥</span>
                    </div>
                </div>
                <div class="form-group">
                    <label>–û–±—ä–µ–º –≥—Ä—É–∑–∞</label>
                    <div class="input-wrapper">
                        <input type="number" id="volume" value="0.1" step="0.001" oninput="calculate()">
                        <span class="input-suffix">–º¬≥</span>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø—Ü–∏–∏</label>
                <div class="checkbox-group">
                    <label class="checkbox-item">
                        <input type="checkbox" id="is_special" onchange="calculate()"> –≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞/–¢–µ–∫—Å—Ç–∏–ª—å (+$0.2/–∫–≥)
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" id="is_replica" onchange="calculate()"> –†–µ–ø–ª–∏–∫–∏ –±—Ä–µ–Ω–¥–æ–≤ (+$0.3/–∫–≥)
                    </label>
                </div>
            </div>

            <div class="form-group">
                <label>–£–ø–∞–∫–æ–≤–∫–∞</label>
                <select id="packaging" onchange="calculate()">
                    <option value="0">–ë–µ–∑ –¥–æ–ø. —É–ø–∞–∫–æ–≤–∫–∏</option>
                    <option value="4">–ú–µ—à–æ–∫ + —Å–∫–æ—Ç—á ($4)</option>
                    <option value="5">–£–≥–æ–ª–∫–∏ + –ú–µ—à–æ–∫ + –°–∫–æ—Ç—á ($5)</option>
                    <option value="8">–î–µ—Ä–µ–≤—è–Ω–Ω–∞—è –æ–±—Ä–µ—à–µ—Ç–∫–∞ ($8)</option>
                    <option value="30">–î–µ—Ä–µ–≤—è–Ω–Ω—ã–π –ø–æ–¥–¥–æ–Ω ($30/–º¬≥)</option>
                </select>
            </div>

            <div class="form-group">
                <label>–°—Ç—Ä–∞—Ö–æ–≤–∫–∞ (–æ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ —Ç–æ–≤–∞—Ä–∞)</label>
                <div class="input-wrapper">
                    <select id="insurance_pct" onchange="calculate()">
                        <option value="0">–ë–µ–∑ —Å—Ç—Ä–∞—Ö–æ–≤–∫–∏</option>
                        <option value="0.01">1% (–ë–∞–∑–æ–≤–∞—è)</option>
                        <option value="0.02">2%</option>
                        <option value="0.03">3%</option>
                        <option value="0.05">5%</option>
                        <option value="0.07">7% (–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è)</option>
                    </select>
                </div>
            </div>

            <div class="form-group">
                <label>–û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å —Ç–æ–≤–∞—Ä–æ–≤ (–¥–ª—è —Å—Ç—Ä–∞—Ö–æ–≤–∫–∏)</label>
                <div class="input-wrapper">
                    <input type="number" id="item_value" value="0" oninput="calculate()">
                    <span class="input-suffix">$</span>
                </div>
            </div>
        </div>

        <!-- Sticky Result Section -->
        <div class="card result-card">
            <div class="result-title">–û—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–æ—á–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å</div>
            <div class="main-price" id="total_display">$0.00</div>
            
            <div class="price-details">
                <div class="detail-row">
                    <span class="detail-label">–ü–ª–æ—Ç–Ω–æ—Å—Ç—å:</span>
                    <span class="detail-value" id="density_val">0 –∫–≥/–º¬≥</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">–¢–∞—Ä–∏—Ñ:</span>
                    <span class="detail-value" id="rate_val">$0.00 / –∫–≥</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">–î–æ—Å—Ç–∞–≤–∫–∞:</span>
                    <span class="detail-value" id="shipping_subtotal">$0.00</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">–£–ø–∞–∫–æ–≤–∫–∞:</span>
                    <span class="detail-value" id="packaging_val">$0.00</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">–°—Ç—Ä–∞—Ö–æ–≤–∫–∞:</span>
                    <span class="detail-value" id="insurance_val">$0.00</span>
                </div>
                <div class="detail-row" style="margin-top: 10px; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 10px;">
                    <span class="detail-label">–†–∞–∑–≥—Ä—É–∑–∫–∞:</span>
                    <span class="detail-value" id="handling_val">300 —Ä—É–±.</span>
                </div>
            </div>

            <div class="warning-box" id="min_weight_warning" style="display:none;">
                ‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ: –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –≤–µ—Å –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ ‚Äî 10 –∫–≥.
            </div>

            <button class="btn-print" onclick="window.print()">
                <span>üñ®Ô∏è –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ</span>
            </button>
        </div>
    </div>

    <!-- Tables Info -->
    <section class="info-section no-print">
        <h2>–¢–∞—Ä–∏—Ñ–Ω—ã–µ —Å–µ—Ç–∫–∏</h2>
        <div class="info-tabs">
            <button class="tab-btn active" onclick="showTable('household')">–•–æ–∑—Ç–æ–≤–∞—Ä—ã</button>
            <button class="tab-btn" onclick="showTable('clothing')">–û–¥–µ–∂–¥–∞</button>
            <button class="tab-btn" onclick="showTable('shoes')">–û–±—É–≤—å</button>
        </div>
        <div class="card" style="padding: 0; overflow: hidden;">
            <table id="data_table">
                <thead>
                    <tr>
                        <th>–ü–ª–æ—Ç–Ω–æ—Å—Ç—å (–∫–≥/–º¬≥)</th>
                        <th>–¶–µ–Ω–∞ ($/–∫–≥)</th>
                        <th>–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ</th>
                    </tr>
                </thead>
                <tbody id="table_body">
                    <!-- Dynamic -->
                </tbody>
            </table>
        </div>
    </section>
</main>

<!-- Hidden Print Template -->
<div id="print-template">
    <div class="print-header">
        <div>
            <div class="logo" style="color: black;">üöÄ –ö–ê–†–ì–û <span style="color: #f39c12;">665</span></div>
            <p>–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ—à–µ–Ω–∏—è</p>
        </div>
        <div style="text-align: right;">
            <p><strong>–î–∞—Ç–∞:</strong> <span id="print_date"></span></p>
            <p><strong>–ú–µ–Ω–µ–¥–∂–µ—Ä:</strong> –†–∞—Å—á–µ—Ç —Å–∏—Å—Ç–µ–º—ã</p>
        </div>
    </div>

    <div class="offer-title">–ö–æ–º–º–µ—Ä—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –ø–æ –¥–æ—Å—Ç–∞–≤–∫–µ</div>
    
    <div class="print-grid">
        <div>
            <h3>–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≥—Ä—É–∑–∞</h3>
            <p><strong>–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</strong> <span id="p_cat"></span></p>
            <p><strong>–í–µ—Å:</strong> <span id="p_weight"></span> –∫–≥</p>
            <p><strong>–û–±—ä–µ–º:</strong> <span id="p_vol"></span> –º¬≥</p>
            <p><strong>–ü–ª–æ—Ç–Ω–æ—Å—Ç—å:</strong> <span id="p_dens"></span> –∫–≥/–º¬≥</p>
        </div>
        <div>
            <h3>–†–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏</h3>
            <p><strong>–ë–∞–∑–æ–≤—ã–π —Ç–∞—Ä–∏—Ñ:</strong> <span id="p_rate"></span></p>
            <p><strong>–°—Ç–æ–∏–º–æ—Å—Ç—å –ª–æ–≥–∏—Å—Ç–∏–∫–∏:</strong> <span id="p_ship"></span></p>
            <p><strong>–£–ø–∞–∫–æ–≤–∫–∞:</strong> <span id="p_pack"></span></p>
            <p><strong>–°—Ç—Ä–∞—Ö–æ–≤–∫–∞:</strong> <span id="p_ins"></span></p>
            <div style="margin-top: 15px; font-size: 20px;">
                <strong>–ò–¢–û–ì–û: <span id="p_total" style="color: #f39c12;"></span></strong>
            </div>
        </div>
    </div>

    <div style="background: #f9f9f9; padding: 20px; border-radius: 8px;">
        <h4>–£—Å–ª–æ–≤–∏—è –ø–µ—Ä–µ–≤–æ–∑–∫–∏:</h4>
        <ul style="margin-left: 20px; font-size: 14px;">
            <li>–°—Ä–æ–∫ –¥–æ—Å—Ç–∞–≤–∫–∏: —Å–æ–≥–ª–∞—Å–Ω–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É —Ç–∞—Ä–∏—Ñ—É.</li>
            <li>–í —Å–ª—É—á–∞–µ —É—Ç–µ—Ä–∏ –≥—Ä—É–∑–∞ –±–µ–∑ —Å—Ç—Ä–∞—Ö–æ–≤–∫–∏ –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç $3-4/–∫–≥.</li>
            <li>–°—Ç—Ä–∞—Ö–æ–≤–æ–π —Å–±–æ—Ä –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –¥–ª—è —Ü–µ–Ω–Ω—ã—Ö –≥—Ä—É–∑–æ–≤.</li>
            <li>–°—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞–∑–≥—Ä—É–∑–∫–∏ –∏ –ø–µ—Ä–µ–¥–∞—á–∏ –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏.</li>
        </ul>
    </div>

    <div class="print-footer">
        <div style="display: flex; justify-content: space-between;">
            <div>
                <strong>–ö–æ–Ω—Ç–∞–∫—Ç—ã –¥–ª—è —Å–≤—è–∑–∏:</strong><br>
                Telegram: t.me/+79160281261<br>
                WhatsApp: wa.me/+79160281261
            </div>
            <div style="text-align: right;">
                –û–û–û "–ö–∞—Ä–≥–æ 665"<br>
                –ü–æ–¥–ø–∏—Å—å: ____________________
            </div>
        </div>
    </div>
</div>

<script>
    // Data structures from the PDF
    const DATA = {
        household: [
            { min: 1000, max: Infinity, price: 1.20 },
            { min: 800, max: 1000, price: 1.30 },
            { min: 600, max: 800, price: 1.40 },
            { min: 500, max: 600, price: 1.50 },
            { min: 400, max: 500, price: 1.60 },
            { min: 350, max: 400, price: 1.70 },
            { min: 300, max: 350, price: 1.80 },
            { min: 250, max: 300, price: 1.90 },
            { min: 200, max: 250, price: 2.00 },
            { min: 190, max: 200, price: 2.10 },
            { min: 180, max: 190, price: 2.20 },
            { min: 170, max: 180, price: 2.30 },
            { min: 160, max: 170, price: 2.40 },
            { min: 150, max: 160, price: 2.50 },
            { min: 140, max: 150, price: 2.60 },
            { min: 130, max: 140, price: 2.70 },
            { min: 120, max: 130, price: 2.80 },
            { min: 110, max: 120, price: 2.90 },
            { min: 100, max: 110, price: 3.00 },
            { min: 0, max: 100, price: 300, isVolume: true }
        ],
        clothing: [
            { min: 400, max: Infinity, price: 2.80 },
            { min: 350, max: 400, price: 2.90 },
            { min: 300, max: 350, price: 3.00 },
            { min: 250, max: 300, price: 3.10 },
            { min: 200, max: 250, price: 3.20 },
            { min: 190, max: 200, price: 3.30 },
            { min: 180, max: 190, price: 3.30 },
            { min: 170, max: 180, price: 3.40 },
            { min: 160, max: 170, price: 3.50 },
            { min: 150, max: 160, price: 3.60 },
            { min: 140, max: 150, price: 3.70 },
            { min: 130, max: 140, price: 3.80 },
            { min: 120, max: 130, price: 3.90 },
            { min: 110, max: 120, price: 4.00 },
            { min: 100, max: 110, price: 4.10 }
        ],
        shoes: [
            { min: 200, max: 250, price: 2.30 },
            { min: 190, max: 200, price: 2.40 },
            { min: 180, max: 190, price: 2.50 },
            { min: 170, max: 180, price: 2.60 },
            { min: 160, max: 170, price: 2.70 },
            { min: 150, max: 160, price: 2.80 },
            { min: 140, max: 150, price: 2.90 },
            { min: 130, max: 140, price: 3.00 },
            { min: 120, max: 130, price: 3.10 },
            { min: 110, max: 120, price: 3.20 },
            { min: 100, max: 110, price: 3.30 },
            { min: 0, max: 100, price: 310, isVolume: true }
        ],
        furniture: [
            { min: 400, max: Infinity, price: 1.70 },
            { min: 350, max: 400, price: 1.80 },
            { min: 300, max: 350, price: 1.90 },
            { min: 250, max: 300, price: 2.00 },
            { min: 200, max: 250, price: 2.10 },
            { min: 190, max: 200, price: 2.20 },
            { min: 180, max: 190, price: 2.30 },
            { min: 170, max: 180, price: 2.40 },
            { min: 160, max: 170, price: 2.50 },
            { min: 150, max: 160, price: 2.60 },
            { min: 140, max: 150, price: 2.70 },
            { min: 130, max: 140, price: 2.80 },
            { min: 120, max: 130, price: 2.90 },
            { min: 110, max: 120, price: 3.00 },
            { min: 100, max: 110, price: 3.10 },
            { min: 0, max: 100, price: 320, isVolume: true }
        ],
        taobao: [
            { min: 0, max: Infinity, price: 7.00 }
        ]
    };

    function calculate() {
        const cat = document.getElementById('category').value;
        const weight = parseFloat(document.getElementById('weight').value) || 0;
        const vol = parseFloat(document.getElementById('volume').value) || 0;
        const isSpecial = document.getElementById('is_special').checked;
        const isReplica = document.getElementById('is_replica').checked;
        const packRate = parseFloat(document.getElementById('packaging').value);
        const insPct = parseFloat(document.getElementById('insurance_pct').value);
        const itemVal = parseFloat(document.getElementById('item_value').value) || 0;

        // Weight validation
        document.getElementById('min_weight_warning').style.display = weight < 10 ? 'block' : 'none';

        if (vol <= 0 || weight <= 0) {
            updateResults(0, 0, 0, 0, 0, 0);
            return;
        }

        const density = weight / vol;
        const rates = DATA[cat];
        let rateObj = rates.find(r => density >= r.min && density < r.max);
        
        // Fallback for edge cases
        if (!rateObj) rateObj = rates[rates.length - 1];

        let basePrice = rateObj.price;
        let shippingCost = 0;

        // Add surcharges
        if (isSpecial) basePrice += 0.2;
        if (isReplica) basePrice += 0.3;

        if (rateObj.isVolume) {
            shippingCost = vol * basePrice;
        } else {
            shippingCost = weight * basePrice;
        }

        // Packaging
        let packagingCost = 0;
        if (packRate === 30) {
            packagingCost = vol * 30;
        } else {
            packagingCost = packRate;
        }

        // Insurance
        const insuranceCost = itemVal * insPct;

        const total = shippingCost + packagingCost + insuranceCost;

        updateResults(total, density, basePrice, shippingCost, packagingCost, insuranceCost, rateObj.isVolume);
        updatePrintTemplate(cat, weight, vol, density, basePrice, shippingCost, packagingCost, insuranceCost, total, rateObj.isVolume);
    }

    function updateResults(total, density, rate, ship, pack, ins, isVol) {
        document.getElementById('total_display').innerText = '$' + total.toFixed(2);
        document.getElementById('density_val').innerText = density.toFixed(1) + ' –∫–≥/–º¬≥';
        document.getElementById('rate_val').innerText = '$' + rate.toFixed(2) + (isVol ? ' / –º¬≥' : ' / –∫–≥');
        document.getElementById('shipping_subtotal').innerText = '$' + ship.toFixed(2);
        document.getElementById('packaging_val').innerText = '$' + pack.toFixed(2);
        document.getElementById('insurance_val').innerText = '$' + ins.toFixed(2);

        // Highlight matching table row
        showTable(document.getElementById('category').value, density);
    }

    function showTable(cat, densityToHighlight = null) {
        // Handle tab buttons
        const btns = document.querySelectorAll('.tab-btn');
        btns.forEach(b => {
            b.classList.remove('active');
            if(b.innerText.toLowerCase().includes(cat.substring(0,3))) b.classList.add('active');
        });

        const tbody = document.getElementById('table_body');
        tbody.innerHTML = '';
        
        const rates = DATA[cat];
        rates.forEach(r => {
            const tr = document.createElement('tr');
            if (densityToHighlight && densityToHighlight >= r.min && densityToHighlight < r.max) {
                tr.className = 'highlight-row';
            }
            
            const range = r.max === Infinity ? `–ë–æ–ª—å—à–µ ${r.min}` : (r.min === 0 ? `–ú–µ–Ω—å—à–µ ${r.max}` : `${r.min}-${r.max}`);
            const price = r.isVolume ? `$${r.price}/–º¬≥` : `$${r.price.toFixed(2)}`;
            
            tr.innerHTML = `
                <td>${range}</td>
                <td>${price}</td>
                <td>${r.isVolume ? '–†–∞—Å—á–µ—Ç –ø–æ –æ–±—ä–µ–º—É' : '–°—Ç–∞–Ω–¥–∞—Ä—Ç'}</td>
            `;
            tbody.appendChild(tr);
        });
    }

    function updatePrintTemplate(cat, weight, vol, density, rate, ship, pack, ins, total, isVol) {
        const catMap = {
            'household': '–•–æ–∑—Ç–æ–≤–∞—Ä—ã',
            'clothing': '–û–¥–µ–∂–¥–∞',
            'shoes': '–û–±—É–≤—å',
            'furniture': '–ú–µ–±–µ–ª—å / –°–ø–µ—Ü–≥—Ä—É–∑',
            'taobao': 'Taobao'
        };
        
        document.getElementById('print_date').innerText = new Date().toLocaleDateString('ru-RU');
        document.getElementById('p_cat').innerText = catMap[cat];
        document.getElementById('p_weight').innerText = weight;
        document.getElementById('p_vol').innerText = vol;
        document.getElementById('p_dens').innerText = density.toFixed(1);
        document.getElementById('p_rate').innerText = '$' + rate.toFixed(2) + (isVol ? ' / –º¬≥' : ' / –∫–≥');
        document.getElementById('p_ship').innerText = '$' + ship.toFixed(2);
        document.getElementById('p_pack').innerText = '$' + pack.toFixed(2);
        document.getElementById('p_ins').innerText = '$' + ins.toFixed(2);
        document.getElementById('p_total').innerText = '$' + total.toFixed(2);
    }

    // Initial load
    window.onload = () => {
        calculate();
    };
</script>

</body>
</html>
